import{_ as H,aw as C,ax as y,u as R,A as p,m as v,n as o,$ as n,am as s,d as a,a1 as c,a9 as A,F as u,V as f,X as i,ap as h,q as _,a0 as k,p as S,a3 as T,a4 as q,a5 as j}from"./index.9022de34.js";import{Q as $}from"./QBadge.3c540cd9.js";import{Q as b}from"./QSpace.fb5f89a7.js";import{Q as N,a as M}from"./QBtnToggle.28ce7519.js";import{Q as F}from"./QImg.ad5480e5.js";import{Q as P}from"./QItemLabel.4dae639c.js";import{Q as G}from"./QList.da851dcd.js";import{Q as U}from"./QAjaxBar.fee622cb.js";import{u as X}from"./CartStore.2adbc30c.js";import"./format.3e32b8d9.js";const J={name:"PosCart",components:{PromoCode:C(()=>y(()=>import("./PromoCode.25283548.js"),["assets/PromoCode.25283548.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QForm.a6c6ef66.js"])),DiscountPromo:C(()=>y(()=>import("./DiscountPromo.48dbedad.js"),["assets/DiscountPromo.48dbedad.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QForm.a6c6ef66.js"])),TipsModal:C(()=>y(()=>import("./TipsModal.544a7931.js"),["assets/TipsModal.544a7931.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QForm.a6c6ef66.js"])),HoldOrders:C(()=>y(()=>import("./HoldOrders.d726827a.js"),["assets/HoldOrders.d726827a.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QForm.a6c6ef66.js","assets/ClosePopup.6b679ccd.js","assets/CartStore.2adbc30c.js"])),SelectCustomer:C(()=>y(()=>import("./SelectCustomer.1998a304.js"),["assets/SelectCustomer.1998a304.js","assets/QSelect.311841ab.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QChip.6eb513c3.js","assets/QItemLabel.4dae639c.js","assets/QMenu.d414cf74.js","assets/selection.5d84a74a.js","assets/rtl.b51694b1.js","assets/format.3e32b8d9.js","assets/CartStore.2adbc30c.js"])),CreateCustomer:C(()=>y(()=>import("./CreateCustomer.c570d70b.js"),["assets/CreateCustomer.c570d70b.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QFooter.864bb069.js","assets/QResizeObserver.129b050c.js","assets/QForm.a6c6ef66.js"])),DeliveryInformation:C(()=>y(()=>import("./DeliveryInformation.afb483d1.js"),["assets/DeliveryInformation.afb483d1.js","assets/QToolbarTitle.5ecfa0aa.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QSelect.311841ab.js","assets/QChip.6eb513c3.js","assets/QItemLabel.4dae639c.js","assets/QMenu.d414cf74.js","assets/selection.5d84a74a.js","assets/rtl.b51694b1.js","assets/format.3e32b8d9.js","assets/QBtnToggle.28ce7519.js","assets/QFooter.864bb069.js","assets/QResizeObserver.129b050c.js","assets/QForm.a6c6ef66.js","assets/CartStore.2adbc30c.js"])),PosCreatePayment:C(()=>y(()=>import("./PosCreatePayment.53a99ab5.js"),["assets/PosCreatePayment.53a99ab5.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QToolbarTitle.5ecfa0aa.js","assets/QSpace.fb5f89a7.js","assets/QToolbar.2a2e526c.js","assets/QBtnToggle.28ce7519.js","assets/QSelect.311841ab.js","assets/QChip.6eb513c3.js","assets/QItemLabel.4dae639c.js","assets/QMenu.d414cf74.js","assets/selection.5d84a74a.js","assets/rtl.b51694b1.js","assets/format.3e32b8d9.js","assets/QForm.a6c6ef66.js","assets/CartStore.2adbc30c.js"]))},setup(){const e=X(),l=R();return{CartStore:e,DataStore:l}},data(){return{add_item:!1,customer_data:[]}},created(){this.loadCart()},updated(){this.$route.query.cart=="open"&&(this.CartStore.cart_drawer=!0)},computed:{canCheckout(){return!!(!this.CartStore.hasData||this.CartStore.hasError||p.empty(this.CartStore.customer_id))},canCheckout2(){return this.DataStore.cart_transaction_type=="delivery"&&Object.keys(this.DataStore.place_data).length<=0}},methods:{loadCart(){let e=this.DataStore.place_data?this.DataStore.place_data.place_id:"";this.CartStore.getCart(this.DataStore.cart_uuid,e)},afterApplypromo(){this.loadCart()},updateCartItems(e,l,x){l=x=="add"?l+1:l-1,this.add_item=!0,p.fetchDataByTokenPost("updateCartItems","cart_uuid="+this.DataStore.cart_uuid+"&row="+e+"&item_qty="+l).then(r=>{this.loadCart()}).catch(r=>{p.notify("red-5",r,"error_outline",this.$q)}).then(r=>{this.add_item=!1})},removeCartItem(e){this.$q.loading.show({spinnerSize:30,spinnerColor:"primary"}),p.fetchDataByTokenPost("removeCartItem","cart_uuid="+this.DataStore.cart_uuid+"&row="+e).then(l=>{this.loadCart()}).catch(l=>{p.notify("red-5",l,"error_outline",this.$q)}).then(l=>{this.$q.loading.hide()})},resetCart(){this.$q.dialog({title:this.$t("Clear all items"),message:this.$t("are you sure?"),transitionShow:"fade",transitionHide:"fade",cancel:!0,ok:{unelevated:!0,color:"primary",rounded:!1,"text-color":"white",size:"md",label:this.$t("Confirm"),"no-caps":!0},cancel:{unelevated:!0,color:"dark","text-color":this.$q.dark.mode?"white":"dark",rounded:!1,outline:!0,size:"md",label:this.$t("Cancel"),"no-caps":!0}}).onOk(()=>{this.DeleteCart()})},DeleteCart(){this.$q.loading.show({spinnerSize:30,spinnerColor:"primary"}),p.fetchDataByTokenPost("clearCart","cart_uuid="+this.DataStore.cart_uuid).then(e=>{this.DataStore.place_data=[],this.loadCart()}).catch(e=>{p.notify("red-5",e,"error_outline",this.$q),this.loadCart()}).then(e=>{this.$q.loading.hide()})},removePromocode(){this.$q.loading.show({spinnerSize:30,spinnerColor:"primary"}),p.fetchDataByTokenPost("removePromocode","cart_uuid="+this.DataStore.cart_uuid).then(e=>{this.loadCart()}).catch(e=>{p.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.$q.loading.hide()})},setTransactionType(){this.$q.loading.show({spinnerSize:30,spinnerColor:"primary"}),p.fetchDataByTokenPost("setTransactionType","cart_uuid="+this.DataStore.cart_uuid+"&transaction_type="+this.DataStore.cart_transaction_type).then(e=>{this.loadCart()}).catch(e=>{p.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.$q.loading.hide()})},createCustomer(){this.$refs.create_customer.dialog=!0},afterCreatecustomer(e){this.customer_data=e,this.CartStore.afterSelectcustomer(this.DataStore.cart_uuid,e.id)},afterPlaceorder(){this.CartStore.cart_drawer=!1},afterHoldorders(){console.log("afterHoldorders"),this.CartStore.cart_drawer=!1,this.loadCart()},removeTips(){this.$q.loading.show({spinnerSize:30,spinnerColor:"primary"}),p.fetchDataByTokenPost("removeTips","cart_uuid="+this.DataStore.cart_uuid).then(e=>{this.loadCart()}).catch(e=>{p.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.$q.loading.hide()})}}},K={class:"flex justify-between items-center q-pa-sm"},W={class:""},Y={class:""},Z={class:"q-pl-sm q-pr-sm"},tt={class:"bg-grey600 radius8"},et={key:0,class:"flex flex-center justify-around bg-grey500 q-pt-xs q-pb-xs"},at={class:"ellipsis",style:{"max-width":"180px"}},rt={key:0,class:"flex flex-center",style:{"min-height":"calc(40vh)"}},ot={class:"text-grey300 q-ma-none"},st={class:"absolute-top-left z-top q-pl-sm"},lt={key:0,class:"no-margin"},nt={key:1,class:"no-margin"},it={key:2,class:"no-margin text-grey"},dt={class:"row q-mt-xs"},ct={class:"col"},ut={class:"no-margin text-weight-bold"},_t={class:"flex items-center q-col-gutter-x-sm"},pt={class:"borderx"},mt={class:"borderx font12"},ht={class:"borderx"},ft={key:0,class:"q-ma-none"},Ct={key:1,class:"q-ma-none"},yt={class:"absolute-bottom bg-grey600"},vt={class:"flex items-center justify-between q-pa-sm"},gt={class:"font12"},kt={class:"text-weight-medium"},St={key:0,class:"q-pl-sm q-pr-sm bg-yellow-2"},bt={class:"flex justify-between fit"};function Dt(e,l,x,r,D,d){const w=v("SelectCustomer"),I=v("PromoCode"),z=v("DiscountPromo"),E=v("TipsModal"),Q=v("CreateCustomer"),V=v("DeliveryInformation"),B=v("PosCreatePayment"),O=v("HoldOrders");return o(),n(u,null,[s("div",K,[s("div",W,[a(c,{flat:"",label:e.$t("Close"),"no-caps":"",size:"md",dense:"",onClick:l[0]||(l[0]=t=>r.CartStore.cart_drawer=!r.CartStore.cart_drawer)},null,8,["label"])]),s("div",Y,[a($,{rounded:"",color:"red",class:"q-pa-sm",label:e.$t("Items in cart ({count})",{count:this.CartStore.getCartCount})},null,8,["label"])])]),s("div",Z,[s("div",tt,[a(w,{ref:"customer",onCreateCustomer:d.createCustomer,options_data:r.CartStore.customer_data?r.CartStore.customer_data:D.customer_data},null,8,["onCreateCustomer","options_data"]),a(b,{class:"q-pa-xs"}),a(N,{modelValue:r.DataStore.cart_transaction_type,"onUpdate:modelValue":l[1]||(l[1]=t=>r.DataStore.cart_transaction_type=t),"toggle-color":"green",unelevated:"","no-caps":"",options:r.CartStore.getTransactionList,spread:"",dense:"",onClick:d.setTransactionType,disable:!r.CartStore.hasData},null,8,["modelValue","options","onClick","disable"]),a(b,{class:"q-pa-xs"}),r.DataStore.cart_transaction_type=="delivery"?(o(),n("div",et,[s("div",null,[a(A,{size:"sm",name:"las la-map-marker"})]),s("div",at,[r.DataStore.hasPlaceData?(o(),n(u,{key:0},[f(i(r.DataStore.place_data.address.address1)+" "+i(r.DataStore.place_data.address.formatted_address),1)],64)):(o(),n(u,{key:1},[f(i(e.$t("Delivery Infomation")),1)],64))]),s("div",null,[a(c,{size:"sm",dense:"",flat:"",icon:"las la-pencil-alt",color:"orange",disable:!r.CartStore.hasData||r.CartStore.customer_id<=0,to:"/pos-order/add-address"},null,8,["disable"])])])):h("",!0)])]),r.CartStore.hasData?h("",!0):(o(),n("div",rt,[s("p",ot,i(e.$t("No items added")),1)])),a(b,{class:"q-pa-sm"}),a(G,{separator:"",dark:""},{default:_(()=>[(o(!0),n(u,null,k(r.CartStore.getItems,t=>(o(),S(T,{key:t},{default:_(()=>[a(q,{avatar:"",top:""},{default:_(()=>[s("div",st,[a(c,{size:"xs",icon:"las la-times",dense:"",color:"red",round:"",onClick:m=>d.removeCartItem(t.cart_row)},null,8,["onClick"])]),a(j,{rounded:""},{default:_(()=>[a(F,{src:t.url_image,fit:"cover","spinner-size":"sm","spinner-color":"primary",style:{height:"50px",width:"50px"}},null,8,["src"])]),_:2},1024)]),_:2},1024),a(q,{top:""},{default:_(()=>[a(P,{class:"text-weight-medium"},{default:_(()=>[f(i(t.item_name)+" ",1),t.price.size_name!=""?(o(),n(u,{key:0},[f(" ("+i(t.price.size_name)+") ",1)],64)):h("",!0)]),_:2},1024),a(P,{caption:""},{default:_(()=>[t.price.discount>0?(o(),n("p",lt,[s("del",null,i(t.price.pretty_price),1),f(" "+i(t.price.pretty_price_after_discount),1)])):(o(),n("p",nt,i(t.price.pretty_price),1)),t.special_instructions!=""?(o(),n("p",it,i(t.special_instructions),1)):h("",!0),t.attributes!=""?(o(!0),n(u,{key:3},k(t.attributes,m=>(o(),n("p",{key:m,class:"no-margin"},[(o(!0),n(u,null,k(m,(g,L)=>(o(),n(u,null,[f(i(g),1),L<m.length-1?(o(),n(u,{key:0},[f(", ")],64)):h("",!0)],64))),256))]))),128)):h("",!0),(o(!0),n(u,null,k(t.addons,m=>(o(),n("div",{key:m},[s("div",dt,[s("div",ct,[s("p",ut,i(m.subcategory_name),1)])]),(o(!0),n(u,null,k(m.addon_items,g=>(o(),n("div",{key:g,class:"flex items-center q-mb-xs q-gutter-x-sm"},[s("div",null,i(g.sub_item_name),1),s("div",null," ("+i(g.qty)+" x "+i(g.pretty_price)+" = "+i(g.pretty_addons_total)+") ",1)]))),128))]))),128))]),_:2},1024),s("div",_t,[s("div",pt,[t.qty<=1?(o(),S(c,{key:0,disable:D.add_item||r.CartStore.cart_loading,onClick:m=>d.removeCartItem(t.cart_row),size:"xs",icon:"las la-trash",dense:"",color:"red"},null,8,["disable","onClick"])):(o(),S(c,{key:1,onClick:m=>d.updateCartItems(t.cart_row,t.qty>1?t.qty--:1,"minus"),disable:D.add_item||r.CartStore.cart_loading,size:"xs",icon:"las la-minus",dense:"",color:"green"},null,8,["onClick","disable"]))]),s("div",mt,i(t.qty),1),s("div",ht,[a(c,{onClick:m=>d.updateCartItems(t.cart_row,t.qty++,"add"),disable:D.add_item||r.CartStore.cart_loading,size:"xs",icon:"las la-plus",dense:"",color:"green"},null,8,["onClick","disable"])]),s("div",null,[t.price.discount<=0?(o(),n("p",ft,i(t.price.pretty_total),1)):(o(),n("p",Ct,i(t.price.pretty_total_after_discount),1))])])]),_:2},1024)]),_:2},1024))),128)),(o(!0),n(u,null,k(r.CartStore.getSummary,t=>(o(),n(u,{key:t},[t.type!="total"?(o(),S(T,{key:0},{default:_(()=>[a(q,null,{default:_(()=>[a(P,{class:"font12"},{default:_(()=>[f(i(t.name)+" ",1),t.type=="voucher"||t.type=="manual_discount"?(o(),S(c,{key:0,size:"xs",icon:"las la-trash",dense:"",color:"red",onClick:d.removePromocode},null,8,["onClick"])):t.type=="tip"?(o(),S(c,{key:1,size:"xs",icon:"las la-trash",dense:"",color:"red",onClick:d.removeTips},null,8,["onClick"])):h("",!0)]),_:2},1024)]),_:2},1024),a(q,{side:""},{default:_(()=>[a(P,{caption:""},{default:_(()=>[f(i(t.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):h("",!0)],64))),128))]),_:1}),a(b,{class:"q-pa-md"}),a(b,{class:"q-pa-xl"}),s("div",yt,[s("div",vt,[s("div",gt,i(e.$t("Total Amount")),1),s("div",kt,i(r.CartStore.getCartTotal.value),1)]),a(M,{outline:"",flat:"",spread:""},{default:_(()=>[a(c,{color:"grey500",label:e.$t("Promo"),"no-caps":"",stack:"",icon:"las la-tag",class:"font11",disable:!r.CartStore.hasData,onClick:l[2]||(l[2]=t=>this.$refs.promo_code.dialog=!0)},null,8,["label","disable"]),a(c,{color:"grey500",label:e.$t("Discount"),"no-caps":"",icon:"las la-percentage",class:"font11",disable:!r.CartStore.hasData,onClick:l[3]||(l[3]=t=>this.$refs.discount_promo.dialog=!0)},null,8,["label","disable"]),r.DataStore.cart_transaction_type!="dinein"?(o(),S(c,{key:0,color:"grey500",label:e.$t("Tips"),"no-caps":"",icon:"lab la-gratipay",class:"font11",disable:!r.CartStore.hasData,onClick:l[4]||(l[4]=t=>this.$refs.tips.dialog=!0)},null,8,["label","disable"])):h("",!0),a(c,{color:"grey500",label:e.$t("Hold"),"no-caps":"",icon:"las la-pause-circle",class:"font11",disable:!r.CartStore.hasData,onClick:l[5]||(l[5]=t=>this.$refs.hold.dialog=!0)},null,8,["label","disable"]),a(c,{color:"grey500",label:e.$t("Reset"),"no-caps":"",icon:"las la-sync",class:"font11",onClick:l[6]||(l[6]=t=>d.resetCart()),disable:!r.CartStore.hasData},null,8,["label","disable"])]),_:1}),r.CartStore.hasError?(o(),n("div",St,[(o(!0),n(u,null,k(r.CartStore.getCartError,t=>(o(),n("div",{key:t,class:"text-dark"},i(t),1))),128))])):h("",!0),s("div",null,[a(c,{color:"green fit","no-caps":"",disable:d.canCheckout||d.canCheckout2,onClick:l[7]||(l[7]=t=>this.$refs.create_payment.dialog=!0),size:"lg"},{default:_(()=>[s("div",bt,[s("div",null,i(e.$t("Proceed to pay")),1),s("div",null,[a(A,{name:"chevron_right"})])])]),_:1},8,["disable"])])]),a(I,{ref:"promo_code",onAfterApplypromo:d.afterApplypromo},null,8,["onAfterApplypromo"]),a(z,{ref:"discount_promo",onAfterApplydiscount:d.afterApplypromo},null,8,["onAfterApplydiscount"]),a(E,{ref:"tips",onAfterApplydiscount:d.afterApplypromo},null,8,["onAfterApplydiscount"]),a(Q,{ref:"create_customer",onAfterCreatecustomer:d.afterCreatecustomer},null,8,["onAfterCreatecustomer"]),a(V,{ref:"delivery_info"},null,512),a(B,{ref:"create_payment",total:r.CartStore.getCartTotal.raw,onAfterPlaceorder:d.afterPlaceorder},null,8,["total","onAfterPlaceorder"]),a(O,{ref:"hold",onAfterHoldorders:d.afterHoldorders},null,8,["onAfterHoldorders"]),a(U,{ref:"bar",position:"top",color:"primary",size:"2px","skip-hijack":""},null,512)],64)}var Vt=H(J,[["render",Dt]]);export{Vt as default};
