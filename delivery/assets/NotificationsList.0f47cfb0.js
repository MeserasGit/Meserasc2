import{ac as V,ad as b,C as x,ae as B,af as _,ai as S,aj as C,ak as I,_ as L,A as g,n as i,$ as u,d as r,q as s,p as c,ap as y,F as m,Z as w,a1 as k,V as Q,X as p,Y as $,a0 as P,am as T,a2 as z,a3 as H,a4 as D,ay as j,a5 as O}from"./index.9022de34.js";import{Q as F}from"./QToolbarTitle.5ecfa0aa.js";import{Q as M}from"./QToolbar.2a2e526c.js";import{Q as R}from"./QHeader.522a2ada.js";import{Q as U}from"./QImg.ad5480e5.js";import{Q as A}from"./QItemLabel.4dae639c.js";import{Q as E}from"./QBadge.3c540cd9.js";import{Q as X}from"./QSlideItem.81c497b9.js";import{Q as Y}from"./QList.da851dcd.js";import{Q as Z}from"./QInnerLoading.788e47b1.js";import{Q as G}from"./QSpinnerDots.97006177.js";import{Q as J}from"./QInfiniteScroll.0e0d2cfe.js";import{Q as K}from"./QPageScroller.ed98b502.js";import{Q as W}from"./QPage.a79a1249.js";import{Q as ee}from"./QPullToRefresh.dea2c8d3.js";import{Q as te}from"./QTab.43d13fc7.js";import{Q as oe}from"./QTabs.a2ac70b0.js";import{Q as ae}from"./QFooter.864bb069.js";import{c as q}from"./selection.5d84a74a.js";import"./QResizeObserver.129b050c.js";import"./TouchPan.f449f070.js";import"./touch.3df10340.js";import"./use-cache.b0833c75.js";import"./use-page-sticky.e99d68f4.js";import"./format.3e32b8d9.js";import"./rtl.b51694b1.js";var ie=V({name:"touch-hold",beforeMount(e,o){const{modifiers:d}=o;if(d.mouse!==!0&&b.has.touch!==!0)return;const t={handler:o.value,noop:x,mouseStart(a){typeof t.handler=="function"&&B(a)===!0&&(_(t,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),t.start(a,!0))},touchStart(a){if(a.target!==void 0&&typeof t.handler=="function"){const n=a.target;_(t,"temp",[[n,"touchmove","move","passiveCapture"],[n,"touchcancel","end","notPassiveCapture"],[n,"touchend","end","notPassiveCapture"]]),t.start(a)}},start(a,n){t.origin=S(a);const f=Date.now();b.is.mobile===!0&&(document.body.classList.add("non-selectable"),q(),t.styleCleanup=h=>{t.styleCleanup=void 0;const v=()=>{document.body.classList.remove("non-selectable")};h===!0?(q(),setTimeout(v,10)):v()}),t.triggered=!1,t.sensitivity=n===!0?t.mouseSensitivity:t.touchSensitivity,t.timer=setTimeout(()=>{t.timer=void 0,q(),t.triggered=!0,t.handler({evt:a,touch:n!==!0,mouse:n===!0,position:t.origin,duration:Date.now()-f})},t.duration)},move(a){const{top:n,left:f}=S(a);t.timer!==void 0&&(Math.abs(f-t.origin.left)>=t.sensitivity||Math.abs(n-t.origin.top)>=t.sensitivity)&&(clearTimeout(t.timer),t.timer=void 0)},end(a){C(t,"temp"),t.styleCleanup!==void 0&&t.styleCleanup(t.triggered),t.triggered===!0?a!==void 0&&I(a):t.timer!==void 0&&(clearTimeout(t.timer),t.timer=void 0)}},l=[600,5,7];if(typeof o.arg=="string"&&o.arg.length!==0&&o.arg.split(":").forEach((a,n)=>{const f=parseInt(a,10);f&&(l[n]=f)}),[t.duration,t.touchSensitivity,t.mouseSensitivity]=l,e.__qtouchhold=t,d.mouse===!0){const a=d.mouseCapture===!0||d.mousecapture===!0?"Capture":"";_(t,"main",[[e,"mousedown","mouseStart",`passive${a}`]])}b.has.touch===!0&&_(t,"main",[[e,"touchstart","touchStart",`passive${d.capture===!0?"Capture":""}`],[e,"touchend","noop","notPassiveCapture"]])},updated(e,o){const d=e.__qtouchhold;d!==void 0&&o.oldValue!==o.value&&(typeof o.value!="function"&&d.end(),d.handler=o.value)},beforeUnmount(e){const o=e.__qtouchhold;o!==void 0&&(C(o,"main"),C(o,"temp"),o.timer!==void 0&&clearTimeout(o.timer),o.styleCleanup!==void 0&&o.styleCleanup(),delete e.__qtouchhold)}});const re={name:"NotificationsList",data(){return{loading:!0,data:[],page:0,data_done:!1,is_refresh:void 0,hold:!1,notification_uuids:[],tab:"delete"}},watch:{hold(e,o){e||(this.notification_uuids=[])}},computed:{hasData(){return Object.keys(this.data).length>0},itemToDelete(){return Object.keys(this.notification_uuids).length}},methods:{refresh(e){this.resetPagination(),this.is_refresh=e},getNotifications(e,o){this.loading=!0,g.fetchDataByTokenPost("getNotification","page="+e).then(d=>{this.page=e,this.data.push(d.details.data)}).catch(d=>{this.data_done=!0,this.$refs.nscroll.stop()}).then(d=>{o(),this.loading=!1,g.empty(this.is_refresh)||this.is_refresh()})},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},deleteNotification(e,o,d){this.data[e].splice(o,1),g.fetchDataByTokenPost("deleteNotification","notification_uuid="+d.notification_uuid).then(t=>{})},handleHold(e){this.hold=!0},resetHold(){this.hold=!1,this.notification_uuids=[]},deleteAllNotification(){g.fetchDataByToken("deleteAllNotification",{notification_uuids:this.notification_uuids}).then(e=>{this.hold=!1,this.resetPagination()}).catch(e=>{}).then(e=>{})},deleteAll(){this.$q.dialog({title:this.$t("Delete all"),message:this.$t("Are you sure want to delete all notifications?"),transitionShow:"fade",transitionHide:"fade",cancel:{unelevated:!0,color:"mygrey",rounded:!0,"text-color":"dark",size:"md",label:this.$t("Cancel"),"no-caps":!0},ok:{unelevated:!0,color:"primary",rounded:!0,"text-color":"white",size:"md",label:this.$t("Okay"),"no-caps":!0}}).onOk(()=>{g.fetchDataByToken("deleteNotifications",{}).then(e=>{this.hold=!1,this.resetPagination()}).catch(e=>{}).then(e=>{})}).onCancel(()=>{}).onDismiss(()=>{})}}},se={key:1,class:"row justify-center q-my-md"},le={key:0,class:"row justify-center q-my-sm"},ne={class:"font12 text-grey"},de={key:1,class:"full-width text-center"},ue={class:"font16 text-weight-bold"},ce={class:"text-grey font12"};function me(e,o,d,t,l,a){return i(),u(m,null,[r(ee,{onRefresh:a.refresh},{default:s(()=>[r(R,{class:w({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:s(()=>[r(M,null,{default:s(()=>[r(k,{onClick:o[0]||(o[0]=n=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r(F,{class:"text-weight-bold"},{default:s(()=>[l.hold?(i(),u(m,{key:0},[Q(p(a.itemToDelete)+" "+p(e.$t("selected")),1)],64)):(i(),u(m,{key:1},[Q(p(e.$t("Notifications")),1)],64))]),_:1}),l.hold?(i(),c(k,{key:0,onClick:o[1]||(o[1]=n=>l.hold=!1),flat:"",round:"",dense:"",icon:"close",color:e.$q.dark.mode?"white":"dark"},null,8,["color"])):(i(),u(m,{key:1},[a.hasData?(i(),c(k,{key:0,onClick:a.deleteAll,flat:"",round:"",dense:"",icon:"las la-trash",color:e.$q.dark.mode?"white":"dark"},null,8,["onClick","color"])):y("",!0)],64))]),_:1}),r($)]),_:1},8,["class"]),r(W,{class:w({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!a.hasData&&!l.loading})},{default:s(()=>[r(J,{ref:"nscroll",onLoad:a.getNotifications,offset:250},{loading:s(()=>[l.page<=0?(i(),c(Z,{key:0,showing:!0,color:"primary",size:"md"})):(i(),u("div",se,[l.data.length>1?(i(),c(G,{key:0,color:"primary",size:"40px"})):y("",!0)]))]),default:s(()=>[r(Y,null,{default:s(()=>[(i(!0),u(m,null,P(l.data,(n,f)=>(i(),u(m,{key:n},[(i(!0),u(m,null,P(n,(h,v)=>(i(),c(X,{key:h,onAction:N=>a.deleteNotification(f,v,h),"right-color":e.$q.dark.mode?"grey600":"mygrey"},{right:s(()=>[r(k,{round:"",color:"lightprimary","text-color":"primary",icon:"las la-trash",unelevated:"",size:"sm"})]),default:s(()=>[z((i(),c(H,{tag:"label",class:w({"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode})},{default:s(()=>[r(D,{avatar:""},{default:s(()=>[l.hold?(i(),c(j,{key:0,modelValue:l.notification_uuids,"onUpdate:modelValue":o[2]||(o[2]=N=>l.notification_uuids=N),val:h.notification_uuid},null,8,["modelValue","val"])):(i(),c(O,{key:1},{default:s(()=>[r(U,{src:h.image,"spinner-color":"primary","spinner-size":"sm"},null,8,["src"])]),_:2},1024))]),_:2},1024),r(D,null,{default:s(()=>[r(A,{lines:"2",class:"text-weight-medium font13"},{default:s(()=>[Q(p(h.message),1)]),_:2},1024),r(A,{caption:"",class:"font11"},{default:s(()=>[Q(p(h.date),1)]),_:2},1024)]),_:2},1024),r(D,{side:""},{default:s(()=>[r(E,{rounded:"",color:"mygrey"})]),_:1})]),_:2},1032,["class"])),[[ie,a.handleHold,void 0,{mouse:!0}]])]),_:2},1032,["onAction","right-color"]))),128))],64))),128))]),_:1})]),_:1},8,["onLoad"]),l.loading?y("",!0):(i(),u(m,{key:0},[a.hasData?(i(),u(m,{key:0},[l.data_done&&l.data.length>=10?(i(),u("div",le,[T("p",ne,p(e.$t("end of results")),1)])):y("",!0)],64)):(i(),u("div",de,[T("div",ue,p(e.$t("No notifications")),1),T("p",ce,p(e.$t("If there is notification it will show here")),1)]))],64)),r(K,{position:"bottom-right","scroll-offset":150,offset:[18,18]},{default:s(()=>[r(k,{fab:"",icon:"keyboard_arrow_up",color:"mygrey","text-color":"dark",dense:"",padding:"3px"})]),_:1})]),_:1},8,["class"])]),_:1},8,["onRefresh"]),l.hold&&a.itemToDelete>0?(i(),c(ae,{key:0,class:"bg-lightprimary"},{default:s(()=>[r(oe,{modelValue:l.tab,"onUpdate:modelValue":o[3]||(o[3]=n=>l.tab=n),class:"text-grey-8","no-caps":"",dense:"",shrink:"","narrow-indicator":"",stretch:"",align:"left",breakpoint:0,"indicator-color":"lightprimary"},{default:s(()=>[r(te,{name:"delete",icon:"las la-trash",label:e.$t("Delete"),onClick:a.deleteAllNotification},null,8,["label","onClick"])]),_:1},8,["modelValue"])]),_:1})):y("",!0)],64)}var He=L(re,[["render",me]]);export{He as default};
