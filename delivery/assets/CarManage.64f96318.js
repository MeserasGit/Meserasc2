import{_ as Q,aw as C,u as P,A as r,m as D,n as i,$ as m,d as o,q as d,Z as c,F as f,a1 as b,V as _,X as p,Y as A,p as h,am as u,a9 as S,ap as U,aq as y,ao as $,ax as w}from"./index.9022de34.js";import{Q as T}from"./QToolbarTitle.5ecfa0aa.js";import{Q as B}from"./QToolbar.2a2e526c.js";import{Q as F}from"./QHeader.522a2ada.js";import{Q as I}from"./QInnerLoading.788e47b1.js";import{Q as v}from"./QImg.ad5480e5.js";import{Q as E}from"./QSpace.fb5f89a7.js";import{Q as V}from"./QSelect.311841ab.js";import{Q as z}from"./QFooter.864bb069.js";import{Q as M}from"./QForm.a6c6ef66.js";import{Q as N}from"./QPage.a79a1249.js";import{A as g}from"./AppCamera.caf1710c.js";import{u as j}from"./DriverStore.9e14cd80.js";import"./QResizeObserver.129b050c.js";import"./QChip.6eb513c3.js";import"./QItemLabel.4dae639c.js";import"./QMenu.d414cf74.js";import"./selection.5d84a74a.js";import"./rtl.b51694b1.js";import"./format.3e32b8d9.js";const L={name:"CarManage",components:{UploaderFile:C(()=>w(()=>import("./UploaderFile.48fb90ea.js"),["assets/UploaderFile.48fb90ea.js","assets/QUploader.49fdd1be.js","assets/index.9022de34.js","assets/index.8b19a20e.css","assets/QCircularProgress.54b08c59.js","assets/format.3e32b8d9.js"]))},data(){return{id:"",data:[],loading:!1,vehicle_type_id:"",plate_number:"",maker:"",model:"",color:"",active:!0,upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:""}},setup(e){const t=P(),n=j();return{DataStore:t,DriverStore:n}},created(){this.DriverStore.VehicleAttributes()},mounted(){this.id=this.$route.query.id,r.empty(this.id)||this.getData()},computed:{isEdit(){return!r.empty(this.id)},hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!r.empty(this.photo)}},methods:{getData(){this.loading=!0,r.fetchDataByTokenPost("getCarInfo","id="+this.id).then(e=>{this.avatar=e.details.avatar,this.photo=e.details.photo,this.upload_path=e.details.path,this.vehicle_type_id=e.details.vehicle_type_id,this.plate_number=e.details.plate_number,this.maker=e.details.maker,this.model=e.details.model,this.color=e.details.color,this.active=e.details.active}).catch(e=>{r.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})},afterInput(e){this.phone=e},formSubmit(){let e={id:this.id,vehicle_type_id:this.vehicle_type_id,plate_number:this.plate_number,maker:this.maker,model:this.model,color:this.color,active:this.active,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""};r.showLoadingBox("",this.$q),r.fetchDataByTokenPost(r.empty(this.id)?"AddCar":"UpdateCar",e).then(t=>{r.notify("light-green",t.msg,"check_circle",this.$q),this.$router.replace({path:"/delivery-management/car"})}).catch(t=>{r.notify("red-5",t,"error_outline",this.$q)}).then(t=>{r.hideLoadingBox(this.$q)})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},takePhoto(){this.$q.capacitor?g.isCameraEnabled().then(e=>{g.isFileAccessEnabled().then(t=>{g.getPhoto(1).then(n=>{this.photo_data=n}).catch(n=>{this.photo_data=[]})}).catch(t=>{r.notify("dark",t,"error",this.$q)})}).catch(e=>{r.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0}}},O={class:"row q-gutter-sm"},G={class:"col"},x={class:"font12 line-normal"},H={class:"q-gutter-y-md"};function J(e,t,n,k,l,s){const q=D("UploaderFile");return i(),m(f,null,[o(F,{class:c({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:d(()=>[o(B,null,{default:d(()=>[o(b,{onClick:t[0]||(t[0]=a=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),o(T,{class:"text-weight-bold"},{default:d(()=>[s.isEdit?(i(),m(f,{key:0},[_(p(e.$t("Update Car")),1)],64)):(i(),m(f,{key:1},[_(p(e.$t("Add Car")),1)],64))]),_:1})]),_:1}),o(A)]),_:1},8,["class"]),o(N,{class:c([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode},"q-pa-md"])},{default:d(()=>[l.loading?(i(),h(I,{key:0,showing:!0,color:"primary",size:"md"})):(i(),h(M,{key:1,onSubmit:s.formSubmit},{default:d(()=>[u("div",O,[s.hasPhotodata?(i(),h(v,{key:0,src:l.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):s.hasPhoto?(i(),h(v,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(i(),m("div",{key:2,class:c(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[o(S,{name:"las la-image",class:"text-grey",size:"xl"})],2)),u("div",G,[u("div",x,p(e.$t("Vehicle Thumbnail. Maximum 2 MB"))+". "+p(e.$t("Accepted types: PNG. JPG")),1),o(b,{label:s.hasPhoto?this.$t("Change Photo"):s.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:s.takePhoto},null,8,["label","onClick"])])]),l.upload_enabled?(i(),h(q,{key:0,ref:"uploader_file",onAfterUploadfile:s.afterUploadfile},null,8,["onAfterUploadfile"])):U("",!0),o(E,{class:"q-pa-sm"}),o(V,{modelValue:l.vehicle_type_id,"onUpdate:modelValue":t[1]||(t[1]=a=>l.vehicle_type_id=a),label:e.$t("Vehicle type"),options:k.DriverStore.getVehicleAttributes.vehicle_type,"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":"",rules:[a=>a&&a>0||this.$t("This field is required")]},null,8,["modelValue","label","options","rules"]),o(y,{modelValue:l.plate_number,"onUpdate:modelValue":t[2]||(t[2]=a=>l.plate_number=a),label:e.$t("Plate number"),"stack-label":"",outlined:"",color:"grey-5",rules:[a=>a&&a.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),u("div",H,[o(V,{modelValue:l.maker,"onUpdate:modelValue":t[3]||(t[3]=a=>l.maker=a),label:e.$t("Car brand"),options:k.DriverStore.getVehicleAttributes.vehicle_maker,"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":""},null,8,["modelValue","label","options"]),o(y,{modelValue:l.model,"onUpdate:modelValue":t[4]||(t[4]=a=>l.model=a),label:e.$t("Model"),"stack-label":"",outlined:"",color:"grey-5"},null,8,["modelValue","label"]),o(y,{modelValue:l.color,"onUpdate:modelValue":t[5]||(t[5]=a=>l.color=a),label:e.$t("Color"),"stack-label":"",outlined:"",color:"grey-5"},null,8,["modelValue","label"]),o($,{modelValue:l.active,"onUpdate:modelValue":t[6]||(t[6]=a=>l.active=a),color:"primary",label:e.$t("Active")},null,8,["modelValue","label"])]),o(z,null,{default:d(()=>[o(b,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ce=Q(L,[["render",J]]);export{ce as default};
